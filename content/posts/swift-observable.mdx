---
title: "Swift çš„ @Observable æ˜¯ä¸ªå•¥ï¼Ÿå€¼ä¸å€¼å¾—ç”¨ï¼Ÿ"
publishedAt: "2025-05-07"
summary: "ç®€å•èŠä¸€ä¸‹ Swift ä¸­çš„ @Observableã€‚"
tags: ["SwiftUI"]
category: "æ•™ç¨‹"
---

Swift è‡ªä»å¼•å…¥ SwiftData å’Œå¯¹ SwiftUI çš„è¿›ä¸€æ­¥ä¼˜åŒ–åï¼Œæ•°æ®é©±åŠ¨çš„ UI ç»‘å®šå˜å¾—è¶Šæ¥è¶Šâ€œä¸æ»‘â€äº†ã€‚è€Œåœ¨ WWDC 2023 ä¹‹åï¼ŒApple æ‚„å’ªå’ªç»™æˆ‘ä»¬å¡äº†ä¸ªè¶…å¥½ç”¨çš„æ–°ç‰¹æ€§ï¼š@Observableã€‚

ä½ å¯ä»¥æŠŠå®ƒç†è§£æˆ @Published å’Œ ObservableObject çš„æ›´ä¼˜é›…æ›¿ä»£å“ï¼Œä½†æ›´ Swiftyã€æ›´è½»é‡ï¼Œä¹Ÿæ›´è‡ªåŠ¨åŒ–ã€‚

## åŸºæœ¬ç”¨æ³• âœ…

æƒ³è±¡ä¸€ä¸‹ä½ æœ‰ä¸€ä¸ª User æ¨¡å‹ï¼Œåœ¨ä»¥å‰çš„ SwiftUI é‡Œï¼Œä½ å¯èƒ½è¿™ä¹ˆå†™ï¼š

```swift
class User: ObservableObject {
    @Published var name: String
    @Published var age: Int

    init(name: String, age: Int) {
        self.name = name
        self.age = age
    }
}

```

ç”¨äº† @Observable ä¹‹åå‘¢ï¼Ÿå˜å¾—ç‚’é¸¡ç®€æ´ï¼

```swift
import Observation

@Observable
class User {
    var name: String
    var age: Int

    init(name: String, age: Int) {
        self.name = name
        self.age = age
    }
}

```

æ˜¯ä¸æ˜¯ç¬é—´æ¸…çˆ½äº†å¾ˆå¤šï¼Ÿ@Publishedã€ObservableObject éƒ½ä¸è¦å†™ï¼Œå±æ€§çš„å˜åŒ– SwiftUI ä¼šè‡ªåŠ¨è§‚å¯Ÿåˆ°ï¼Œç®€ç›´æ˜¯æ‡’äººç¦éŸ³ï¼ˆæˆ‘çˆ±äº†ï¼‰ã€‚

## èƒŒåçš„é­”æ³• âœ¨

@Observable æœ¬è´¨ä¸Šæ˜¯ä¸ªå®ï¼ˆMacroï¼‰ï¼Œå®ƒåœ¨ç¼–è¯‘æ—¶ä¼šè‡ªåŠ¨å¸®ä½ ç”Ÿæˆè§‚å¯ŸåŠŸèƒ½ã€‚ä½ ä¸ç”¨æ˜¾å¼å†™ objectWillChange.send()ï¼Œä¹Ÿä¸ç”¨æ‹…å¿ƒå¿˜è®°ç»™å±æ€§åŠ  @Publishedï¼Œä¸€åˆ‡éƒ½å°è£…å¾—å¦¥å¦¥çš„ã€‚

åªè¦ä½ ç”¨çš„æ˜¯ Swift 5.9+ï¼ˆXcode 15+ï¼‰ï¼Œå°±èƒ½ç›´æ¥äº«ç”¨è¿™ç³–åˆ†çˆ†è¡¨çš„è¯­æ³•ç³–ã€‚

## å’Œ SwiftUI çš„è”åŠ¨ ğŸ‘¯â€â™€ï¸

ä½ å¯ä»¥ç›´æ¥æŠŠ @State, @Bindable, æˆ–è€… @Environment ç­‰å±æ€§ç»‘å®šåˆ°è¿™ä¸ªæ¨¡å‹ä¸Šï¼Œæ•ˆæœä¸€çº§æ£’ï¼

```swift
@State private var user = User(name: "å‡¯é˜³", age: 24)

var body: some View {
    TextField("åå­—", text: $user.name)
    Stepper("å¹´é¾„ï¼š\(user.age)", value: $user.age)
}

```

æ³¨æ„è¿™é‡Œçš„ user æ˜¯ä¸€ä¸ª struct æˆ– class å®ä¾‹ï¼ˆå–å†³äºä½ æ€ä¹ˆè®¾è®¡ï¼‰ï¼Œä½†å®ƒçš„å±æ€§å¯ä»¥ç›´æ¥ç»‘å®šï¼Œå› ä¸º @Observable å·²ç»è‡ªåŠ¨å¤„ç†äº†è§‚å¯Ÿé€»è¾‘ã€‚

## æ³¨æ„äº‹é¡¹ âš ï¸

@Observable åªæ”¯æŒ Swift çš„åŸç”Ÿç±»å‹ï¼ˆç›®å‰ä¸ºæ­¢ï¼‰ï¼Œå¦‚æœä½ ç”¨äº†ä¸€äº› Objective-C çš„ä¸œè¥¿ï¼Œæ¯”å¦‚ NSObject æˆ–è€æ´¾ KVOï¼Œé‚£è¿˜æ˜¯å¾—ä¹–ä¹–ç”¨ @Publishedã€‚

å¦‚æœä½ å¸Œæœ›ç”¨ struct ä½œä¸ºæ¨¡å‹ï¼Œä¹Ÿå¯ä»¥ï¼Œä½†è¦å°å¿ƒå€¼ç±»å‹å¯¼è‡´çš„ copy è¡Œä¸ºï¼Œæ¨èé…åˆ @State æˆ– @Bindableã€‚

ä¸èƒ½ç›´æ¥ä½œç”¨äº enumï¼

## ç»“è¯­ ğŸ§ 

@Observable æ˜¯ Apple å‘æˆ‘ä»¬å¼€å‘è€…å‘å°„çš„ä¸€é¢—â€œè¯­æ³•ç³–ç‚¸å¼¹â€ï¼Œè®© UI å’Œæ•°æ®çš„ç»‘å®šå˜å¾—æ›´åŠ ç›´è§‚ã€å¼ºå¤§ä¸”æ˜“ç»´æŠ¤ã€‚å¯¹æ¯”æ—§æ—¶ä»£çš„ ObservableObjectï¼Œè¿™æ³¢ç¡®å®æ˜¯æŠ€æœ¯å€ºå‡å… + å¯è¯»æ€§é£å‡çš„ä¸€æ­¥ã€‚

å¼ºçƒˆå»ºè®®é¡¹ç›®é‡æ„æˆ–æ–°é¡¹ç›®ç›´æ¥ä¸Š @Observableï¼Œçˆ½åˆ°é£èµ· ğŸš€
